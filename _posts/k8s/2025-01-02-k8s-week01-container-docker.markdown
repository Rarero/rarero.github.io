---
layout: post
title: "[k8s] Week 1. Containerì™€ Dockerì˜ ì´í•´"
date: 2025-01-02 09:00:00 +0900
tags: [Docker, Container, Image, Dockerfile, Lifecycle, Architecture]
categories: k8s
---

Kubernetesë¥¼ ì œëŒ€ë¡œ ì´í•´í•˜ë ¤ë©´ ë¨¼ì € ì»¨í…Œì´ë„ˆ ê¸°ìˆ ì˜ ê¸°ì´ˆë¥¼ íƒ„íƒ„íˆ ë‹¤ì ¸ì•¼ í•©ë‹ˆë‹¤. ì´ë²ˆ ì£¼ì—ëŠ” Dockerê°€ ì™œ ë“±ì¥í–ˆê³ , ì–´ë–»ê²Œ IT ì¸í”„ë¼ì˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ë°”ê¿¨ëŠ”ì§€ë¶€í„° ì‹œì‘í•˜ì—¬, Dockerë¥¼ ì„¤ì¹˜í•˜ê³  ê¸°ë³¸ ëª…ë ¹ì–´ë¡œ ì»¨í…Œì´ë„ˆ ë¼ì´í”„ì‚¬ì´í´ì„ ì§ì ‘ ì²´í—˜í•©ë‹ˆë‹¤.

> ì°¸ê³ : [roadmap.sh/docker](https://roadmap.sh/docker)ì˜ "Introduction", "Basics of Docker", "Installation/Setup" í•­ëª©ì„ ì»¤ë²„í•©ë‹ˆë‹¤.

<br>

## í•™ìŠµ ëª©í‘œ

- ë¬¼ë¦¬ ì„œë²„ â†’ ê°€ìƒ ë¨¸ì‹  â†’ ì»¨í…Œì´ë„ˆë¡œì˜ ì§„í™” ê³¼ì • ì´í•´
- Docker ì„¤ì¹˜ ë° í™˜ê²½ êµ¬ì„±
- Docker ì•„í‚¤í…ì²˜ (Client-Server ëª¨ë¸) ì´í•´
- ì»¨í…Œì´ë„ˆ ë¼ì´í”„ì‚¬ì´í´ ì „ì²´ ê´€ë¦¬
- docker run ëª…ë ¹ì–´ì˜ ë‚´ë¶€ ë™ì‘ ë¶„ì„
- ì´ë¯¸ì§€ì™€ ì»¨í…Œì´ë„ˆì˜ ê´€ê³„, ì´ë¯¸ì§€ ë ˆì´ì–´ ê¸°ì´ˆ
- docker save/loadë¥¼ í†µí•œ ì´ë¯¸ì§€ ì´ì‹ì„± í™œìš©

<br>

## 1. Containerì˜ ë“±ì¥ ë°°ê²½

### 1.1 ë¬¼ë¦¬ ì„œë²„ ì‹œëŒ€

í•œ ëŒ€ì˜ ë¬¼ë¦¬ ì„œë²„ì— í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ë˜ ì‹œì ˆì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Physical Server          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Operating System        â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚   â”‚   Application       â”‚ â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        CPU, Memory, Disk        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¬¸ì œì :**
- **ë¦¬ì†ŒìŠ¤ ë‚­ë¹„**: ì„œë²„ ìì›ì˜ í‰ê·  10~15%ë§Œ ì‚¬ìš©
- **í™•ì¥ì„± ë¶€ì¡±**: ìƒˆ ì„œë²„ êµ¬ë§¤ ë° ì„¤ì¹˜ì— ìˆ˜ ì£¼ ì†Œìš”
- **ìš´ì˜ ë¹„ìš©**: ì„œë²„ì‹¤ ê³µê°„, ì „ë ¥, ëƒ‰ê° ë¹„ìš©
- **í™˜ê²½ ë¶ˆì¼ì¹˜**: "ë‚´ ì»´í“¨í„°ì—ì„œëŠ” ë˜ëŠ”ë°ìš”?" ë¬¸ì œ

ì‹¤ì œ ì‚¬ë¡€ë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

2005ë…„, ë‹¹ì‹ ì´ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ëŠ” íšŒì‚¬ì˜ ê°œë°œìë¼ê³  ê°€ì •í•´ë´…ì‹œë‹¤.
- ê°œë°œ í™˜ê²½: Windows 10, PHP 7.2, MySQL 5.7
- í…ŒìŠ¤íŠ¸ ì„œë²„: CentOS 7, PHP 7.0, MySQL 5.6
- ìš´ì˜ ì„œë²„: RHEL 6, PHP 5.6, MySQL 5.5

ê°œë°œì—ì„œ ì™„ë²½íˆ ë™ì‘í•˜ë˜ ì½”ë“œê°€ ìš´ì˜ ì„œë²„ì—ì„œ ì˜¤ë¥˜ë¥¼ ì¼ìœ¼í‚µë‹ˆë‹¤. PHP ë²„ì „ ì°¨ì´ë¡œ ì¸í•œ í•¨ìˆ˜ í˜¸í™˜ì„± ë¬¸ì œì˜€ìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ ìš´ì˜ ì„œë²„ì˜ PHPë¥¼ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í•˜ëŠ”ë°, ë‹¤ë¥¸ ë ˆê±°ì‹œ ì‹œìŠ¤í…œì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆì–´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

---

### 1.2 ê°€ìƒ ë¨¸ì‹ (VM) ì‹œëŒ€

VMware, Hyper-V, KVM ë“±ìœ¼ë¡œ í•œ ëŒ€ì˜ ë¬¼ë¦¬ ì„œë²„ì— ì—¬ëŸ¬ ê°€ìƒ ë¨¸ì‹ ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Physical Server                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Hypervisor (ESXi, KVM)             â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚   VM 1   â”‚   VM 2   â”‚   VM 3   â”‚   VM 4   â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚Guest â”‚ â”‚ â”‚Guest â”‚ â”‚ â”‚Guest â”‚ â”‚ â”‚Guest â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  OS  â”‚ â”‚ â”‚  OS  â”‚ â”‚ â”‚  OS  â”‚ â”‚ â”‚  OS  â”‚ â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚ â”‚ App  â”‚ â”‚ â”‚ App  â”‚ â”‚ â”‚ App  â”‚ â”‚ â”‚ App  â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              CPU, Memory, Disk                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê°œì„ ì :**
- ë¦¬ì†ŒìŠ¤ í™œìš©ë¥  í–¥ìƒ: í•˜ë‚˜ì˜ ë¬¼ë¦¬ ì„œë²„ì— ì—¬ëŸ¬ VM
- ê²©ë¦¬: ê° VMì€ ë…ë¦½ì ì¸ í™˜ê²½
- ìŠ¤ëƒ…ìƒ·: íŠ¹ì • ì‹œì ìœ¼ë¡œ ë³µì› ê°€ëŠ¥

**ì—¬ì „í•œ ë¬¸ì œì :**
- **ë¬´ê±°ì›€**: ê° VMë§ˆë‹¤ ì „ì²´ Guest OS í•„ìš” (ìˆ˜ GB)
- **ëŠë¦° ì‹œì‘**: VM ë¶€íŒ…ì— ìˆ˜ ë¶„ ì†Œìš”
- **ë¦¬ì†ŒìŠ¤ ì˜¤ë²„í—¤ë“œ**: Guest OSê°€ ë©”ëª¨ë¦¬ 1~2GB ì ìœ 
- **ì´ì‹ì„± ë¶€ì¡±**: VM ì´ë¯¸ì§€ ì´ë™ì´ ëŠë¦¬ê³  ë³µì¡

ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤:
- ê°œë°œìê°€ ë¡œì»¬ì—ì„œ Ubuntu VM ìƒì„± (10ë¶„ ì†Œìš”, 4GB ë©”ëª¨ë¦¬ í• ë‹¹)
- VMì— ì›¹ ì„œë²„ ì„¤ì¹˜ ë° ì„¤ì • (30ë¶„)
- ê°™ì€ í™˜ê²½ì„ í…ŒìŠ¤íŠ¸ ì„œë²„ì— ë³µì œí•˜ë ¤ë©´ VM ì´ë¯¸ì§€ ì „ì†¡ (ìˆ˜ì‹­ GB, ìˆ˜ ì‹œê°„)
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ 10ê°œë¥¼ ë„ìš°ë ¤ë©´ VM 10ê°œ í•„ìš” (40GB ë©”ëª¨ë¦¬ ì†Œëª¨)

---

### 1.3 Container ì‹œëŒ€ì˜ ê°œë§‰ (2013ë…„)

Solomon Hykesê°€ PyConì—ì„œ Dockerë¥¼ ë°œí‘œí–ˆì„ ë•Œ, ê·¸ëŠ” ì´ë ‡ê²Œ ë§í–ˆìŠµë‹ˆë‹¤:

> "Build once, run anywhere" (í•œ ë²ˆ ë¹Œë“œí•˜ë©´ ì–´ë””ì„œë“  ì‹¤í–‰)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Physical Server / VM                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Host Operating System              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚         Docker Engine                      â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Cont 1 â”‚ Cont 2 â”‚ Cont 3 â”‚ Cont 4 â”‚ Cont 5 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚App â”‚ â”‚ â”‚App â”‚ â”‚ â”‚App â”‚ â”‚ â”‚App â”‚ â”‚ â”‚App â”‚ â”‚  â”‚
â”‚  â”‚ â”‚Libsâ”‚ â”‚ â”‚Libsâ”‚ â”‚ â”‚Libsâ”‚ â”‚ â”‚Libsâ”‚ â”‚ â”‚Libsâ”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              CPU, Memory, Disk                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**VM vs Container í•µì‹¬ ì°¨ì´:**

| &nbsp;í•­ëª©&nbsp; | &nbsp;VM&nbsp; | &nbsp;Container&nbsp; |
|---|---|---|
| OS | ê°ê° ì „ì²´ Guest OS | í˜¸ìŠ¤íŠ¸ OS ì»¤ë„ ê³µìœ  |
| í¬ê¸° | ìˆ˜ GB | ìˆ˜ì‹­ MB |
| ì‹œì‘ ì‹œê°„ | ìˆ˜ ë¶„ | ìˆ˜ ì´ˆ |
| ê²©ë¦¬ ìˆ˜ì¤€ | í•˜ë“œì›¨ì–´ ìˆ˜ì¤€ (ì™„ì „ ê²©ë¦¬) | í”„ë¡œì„¸ìŠ¤ ìˆ˜ì¤€ (ì»¤ë„ ê³µìœ ) |
| ë°€ë„ | ì„œë²„ë‹¹ ìˆ˜ì‹­ ê°œ | ì„œë²„ë‹¹ ìˆ˜ë°±~ìˆ˜ì²œ ê°œ |
| ì´ì‹ì„± | ëŠë¦¬ê³  ë³µì¡ | ì´ë¯¸ì§€ í•˜ë‚˜ë¡œ ì–´ë””ì„œë“  ì‹¤í–‰ |

> ì°¸ê³ : [Docker ê³µì‹ ë¬¸ì„œ, "What is a Container?"](https://docs.docker.com/get-started/overview/#what-is-a-container)

<br>

## 2. Dockerê°€ ê°€ì ¸ì˜¨ ë³€í™”

### 2.1 ê°œë°œ í™˜ê²½ í‘œì¤€í™”

ê¸°ì¡´:
```
ê°œë°œì A: Mac + PHP 7.2 + MySQL 5.7
ê°œë°œì B: Windows + PHP 7.4 + PostgreSQL 12
ìš´ì˜ ì„œë²„: Linux + PHP 7.0 + MySQL 5.6
â†’ í™˜ê²½ ì°¨ì´ë¡œ ì¸í•œ ë²„ê·¸ ë°œìƒ
```

Docker ì‚¬ìš© í›„:
```dockerfile
FROM php:7.2-apache
RUN docker-php-ext-install mysqli
COPY . /var/www/html

# â†’ ëª¨ë“  í™˜ê²½ì—ì„œ ë™ì¼í•œ ì´ë¯¸ì§€ ì‚¬ìš©
```

---

### 2.2 ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

ê¸°ì¡´ ëª¨ë†€ë¦¬ì‹:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ê±°ëŒ€í•œ ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜     â”‚
â”‚  - User Management             â”‚
â”‚  - Order Processing            â”‚
â”‚  - Payment                     â”‚
â”‚  - Inventory                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†’ í•˜ë‚˜ ìˆ˜ì •í•˜ë©´ ì „ì²´ ì¬ë°°í¬
```

Docker ê¸°ë°˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚ â”‚  Order   â”‚ â”‚ Payment  â”‚ â”‚Inventory â”‚
â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†’ ê° ì„œë¹„ìŠ¤ ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ ë° í™•ì¥
```

---

### 2.3 CI/CD íŒŒì´í”„ë¼ì¸ í˜ì‹ 

ê¸°ì¡´:
```
1. ì½”ë“œ ì»¤ë°‹
2. ë¹Œë“œ ì„œë²„ì—ì„œ ì»´íŒŒì¼
3. í…ŒìŠ¤íŠ¸ ì„œë²„ì— ìˆ˜ë™ ë°°í¬
4. QA í…ŒìŠ¤íŠ¸
5. ìš´ì˜ ì„œë²„ì— ìˆ˜ë™ ë°°í¬ (ìƒˆë²½ ì‘ì—…)
â†’ ë°°í¬ ì£¼ê¸°: ì›” 1íšŒ
```

Docker ê¸°ë°˜:
```
1. ì½”ë“œ ì»¤ë°‹
2. Docker ì´ë¯¸ì§€ ë¹Œë“œ (ìë™)
3. ì´ë¯¸ì§€ë¡œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ìë™)
4. ì´ë¯¸ì§€ë¥¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— í‘¸ì‹œ (ìë™)
5. ìš´ì˜ í™˜ê²½ì— ì´ë¯¸ì§€ ë°°í¬ (ìë™, ë¡¤ë°± ê°€ëŠ¥)
â†’ ë°°í¬ ì£¼ê¸°: ì¼ ìˆ˜ì‹­ íšŒ
```

<br>

## 3. Docker ì„¤ì¹˜ ë° í™˜ê²½ êµ¬ì„±

### 3.1 Docker Desktop vs Docker Engine

| &nbsp;í•­ëª©&nbsp; | &nbsp;Docker Desktop&nbsp; | &nbsp;Docker Engine&nbsp; |
|---|---|---|
| ëŒ€ìƒ | Mac, Windows, Linux (GUI í™˜ê²½) | Linux ì„œë²„ (CLI í™˜ê²½) |
| í¬í•¨ ë‚´ìš© | Docker Engine + Compose + GUI + K8s | Docker Engine + CLIë§Œ |
| ë¼ì´ì„ ìŠ¤ | ëŒ€ê·œëª¨ ê¸°ì—… ìœ ë£Œ | ë¬´ë£Œ (CE) |
| ìš©ë„ | ê°œë°œ í™˜ê²½ | í”„ë¡œë•ì…˜ ì„œë²„ |

### 3.2 Docker ì„¤ì¹˜ (Ubuntu ì˜ˆì‹œ)

```bash
# ì´ì „ ë²„ì „ ì œê±°
sudo apt-get remove docker docker-engine docker.io containerd runc

# ì €ì¥ì†Œ ì„¤ì •
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg

# Docker GPG í‚¤ ì¶”ê°€
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
  sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

# Docker ì €ì¥ì†Œ ì¶”ê°€
echo \
  "deb [arch=$(dpkg --print-architecture) \
  signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# Docker ì„¤ì¹˜
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io \
  docker-buildx-plugin docker-compose-plugin

# í˜„ì¬ ì‚¬ìš©ìë¥¼ docker ê·¸ë£¹ì— ì¶”ê°€ (sudo ì—†ì´ ì‚¬ìš© ê°€ëŠ¥)
sudo usermod -aG docker $USER
newgrp docker
```

### 3.3 ì„¤ì¹˜ í™•ì¸

```bash
# Docker ë²„ì „ í™•ì¸
docker version
# Client:
#  Version:    24.0.x
# Server:
#  Version:    24.0.x

# Docker ì‹œìŠ¤í…œ ì •ë³´ í™•ì¸
docker info
# ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„, CPU/ë©”ëª¨ë¦¬, ì‹¤í–‰ ì¤‘ ì»¨í…Œì´ë„ˆ ìˆ˜ ë“±

# Hello Worldë¡œ ì •ìƒ ë™ì‘ í™•ì¸
docker run hello-world
# Hello from Docker!
# This message shows that your installation appears to be working correctly.
```

> ì°¸ê³ : [Docker ê³µì‹ ì„¤ì¹˜ ê°€ì´ë“œ (Ubuntu)](https://docs.docker.com/engine/install/ubuntu/)

<br>

## 4. Docker ì•„í‚¤í…ì²˜

DockerëŠ” **Client-Server** ì•„í‚¤í…ì²˜ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Client (CLI)                           â”‚
â”‚  $ docker run, docker build, docker push       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ REST API (Unix Socket / TCP)
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Daemon (dockerd)                       â”‚
â”‚  - ì´ë¯¸ì§€ ê´€ë¦¬                                  â”‚
â”‚  - ì»¨í…Œì´ë„ˆ ìƒëª…ì£¼ê¸° ê´€ë¦¬                        â”‚
â”‚  - ë„¤íŠ¸ì›Œí¬ ê´€ë¦¬                                â”‚
â”‚  - ë³¼ë¥¨ ê´€ë¦¬                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  containerd (ê³ ìˆ˜ì¤€ ëŸ°íƒ€ì„)   â”‚              â”‚
â”‚  â”‚  - ì´ë¯¸ì§€ pull/push          â”‚              â”‚
â”‚  â”‚  - ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ê´€ë¦¬         â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚             â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  runc (ì €ìˆ˜ì¤€ ëŸ°íƒ€ì„)         â”‚              â”‚
â”‚  â”‚  - Namespace ìƒì„±            â”‚              â”‚
â”‚  â”‚  - Cgroups ì„¤ì •              â”‚              â”‚
â”‚  â”‚  - ì‹¤ì œ í”„ë¡œì„¸ìŠ¤ ìƒì„±         â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Registry (Docker Hub ë“±)               â”‚
â”‚  - ì´ë¯¸ì§€ ì €ì¥/ë°°í¬                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• :**

| &nbsp;ì»´í¬ë„ŒíŠ¸&nbsp; | &nbsp;ì—­í• &nbsp; | &nbsp;ì„¤ëª…&nbsp; |
|---|---|---|
| Docker Client | ëª…ë ¹ì–´ ì¸í„°í˜ì´ìŠ¤ | ì‚¬ìš©ìê°€ docker ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ Daemonì— REST API ìš”ì²­ |
| Docker Daemon (dockerd) | í•µì‹¬ ì„œë¹„ìŠ¤ | ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì´ë¯¸ì§€, ì»¨í…Œì´ë„ˆ, ë„¤íŠ¸ì›Œí¬, ë³¼ë¥¨ì„ ê´€ë¦¬ |
| containerd | ê³ ìˆ˜ì¤€ ëŸ°íƒ€ì„ | ì´ë¯¸ì§€ ê´€ë¦¬, ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ìš”ì²­ì„ runcì— ì „ë‹¬ |
| runc | ì €ìˆ˜ì¤€ ëŸ°íƒ€ì„ | Linux Namespace/Cgroupsë¥¼ ìƒì„±í•˜ì—¬ ì‹¤ì œ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ |
| Registry | ì´ë¯¸ì§€ ì €ì¥ì†Œ | Docker Hub (ê³µê°œ), ACR/ECR (ë¹„ê³µê°œ) ë“± |

> **ğŸ’¡ í•µì‹¬**: Docker CLIëŠ” ë‹¨ìˆœí•œ í´ë¼ì´ì–¸íŠ¸ì´ê³ , ì‹¤ì œ ì‘ì—…ì€ Docker Daemonì´ ìˆ˜í–‰í•©ë‹ˆë‹¤. containerdì™€ runcëŠ” Week 2ì—ì„œ ì‹¬ë„ ìˆê²Œ ë‹¤ë£¹ë‹ˆë‹¤.

> ì°¸ê³ : [Docker ê³µì‹ ë¬¸ì„œ, "Docker Architecture"](https://docs.docker.com/get-started/overview/#docker-architecture)

<br>

## 5. ì´ë¯¸ì§€ì™€ ì»¨í…Œì´ë„ˆì˜ ê´€ê³„

### 5.1 ì´ë¯¸ì§€ = ì½ê¸° ì „ìš© í…œí”Œë¦¿

Docker ì´ë¯¸ì§€ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“¤ê¸° ìœ„í•œ **ì½ê¸° ì „ìš© í…œí”Œë¦¿**ì…ë‹ˆë‹¤.

ë¹„ìœ :
- **ì´ë¯¸ì§€** = ë¶•ì–´ë¹µ **í‹€** (ì¬ì‚¬ìš© ê°€ëŠ¥)
- **ì»¨í…Œì´ë„ˆ** = í‹€ë¡œ ë§Œë“  **ë¶•ì–´ë¹µ** (ì‹¤í–‰ ì¸ìŠ¤í„´ìŠ¤)

í•˜ë‚˜ì˜ í‹€(ì´ë¯¸ì§€)ë¡œ ì—¬ëŸ¬ ê°œì˜ ë¶•ì–´ë¹µ(ì»¨í…Œì´ë„ˆ)ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  nginx:latest   â”‚  â† ì´ë¯¸ì§€ (ì½ê¸° ì „ìš©)
â”‚  (Image)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ docker run
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Container A    â”‚    â”‚  Container B    â”‚
â”‚  (Running)      â”‚    â”‚  (Running)      â”‚
â”‚  Port: 8080     â”‚    â”‚  Port: 8081     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ì´ë¯¸ì§€ ë ˆì´ì–´ êµ¬ì¡° (ê¸°ì´ˆ)

ì´ë¯¸ì§€ëŠ” ì—¬ëŸ¬ ê°œì˜ **ë ˆì´ì–´(Layer)**ê°€ ìŒ“ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤. ê° ë ˆì´ì–´ëŠ” ì½ê¸° ì „ìš©ì´ë©°, ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ìµœìƒë‹¨ì— **ì“°ê¸° ê°€ëŠ¥í•œ ë ˆì´ì–´**ê°€ ì¶”ê°€ë©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Container Layer (RW)   â”‚  â† ì»¨í…Œì´ë„ˆì—ì„œ ìˆ˜ì •ëœ íŒŒì¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 4 (RO)           â”‚  â† CMD ["nginx"]
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3 (RO)           â”‚  â† COPY html /usr/share/nginx/
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2 (RO)           â”‚  â† RUN apt-get install nginx
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 1 (RO)           â”‚  â† FROM ubuntu:22.04
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash
# ì´ë¯¸ì§€ ë ˆì´ì–´ í™•ì¸
docker history nginx:latest
# IMAGE          CREATED       CREATED BY                                      SIZE
# 3b25b682...    2 weeks ago   CMD ["nginx" "-g" "daemon off;"]                0B
# <missing>      2 weeks ago   STOPSIGNAL SIGQUIT                              0B
# <missing>      2 weeks ago   EXPOSE 80                                       0B
# <missing>      2 weeks ago   COPY docker-entrypoint.d/... /docker-entry...   4.62kB
# ...
```

> ì°¸ê³ : ë ˆì´ì–´ì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ (OverlayFS)ëŠ” Week 2ì—ì„œ ìƒì„¸íˆ ë‹¤ë£¹ë‹ˆë‹¤.

<br>

## 6. ì»¨í…Œì´ë„ˆ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬

### 6.1 ê¸°ë³¸ ëª…ë ¹ì–´ ì „ì²´ ì •ë¦¬

```bash
# ===== ì´ë¯¸ì§€ ê´€ë¦¬ =====
docker pull nginx:latest       # ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
docker images                  # ë¡œì»¬ ì´ë¯¸ì§€ ëª©ë¡
docker rmi nginx:latest        # ì´ë¯¸ì§€ ì‚­ì œ
docker image prune             # ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ ì •ë¦¬

# ===== ì»¨í…Œì´ë„ˆ ìƒì„± & ì‹¤í–‰ =====
docker run nginx               # ì´ë¯¸ì§€ë¡œ ì»¨í…Œì´ë„ˆ ìƒì„±+ì‹¤í–‰ (í¬ê·¸ë¼ìš´ë“œ)
docker run -d nginx             # ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (-d: detach)
docker run -it ubuntu bash      # ì¸í„°ë™í‹°ë¸Œ ëª¨ë“œ (-i: stdin, -t: tty)
docker create nginx             # ì»¨í…Œì´ë„ˆ ìƒì„±ë§Œ (ì‹¤í–‰ ì•ˆ í•¨)
docker start <container_id>     # ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ ì‹œì‘

# ===== ì»¨í…Œì´ë„ˆ ì¡°íšŒ =====
docker ps                       # ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëª©ë¡
docker ps -a                    # ëª¨ë“  ì»¨í…Œì´ë„ˆ (ì¤‘ì§€ í¬í•¨)
docker ps -q                    # ì»¨í…Œì´ë„ˆ IDë§Œ ì¶œë ¥

# ===== ì»¨í…Œì´ë„ˆ ì¤‘ì§€ & ì‚­ì œ =====
docker stop <container_id>      # ì •ìƒ ì¢…ë£Œ (SIGTERM â†’ 10ì´ˆ í›„ SIGKILL)
docker kill <container_id>      # ê°•ì œ ì¢…ë£Œ (SIGKILL ì¦‰ì‹œ)
docker rm <container_id>        # ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ ì‚­ì œ
docker rm -f <container_id>     # ì‹¤í–‰ ì¤‘ì´ì–´ë„ ê°•ì œ ì‚­ì œ

# ===== ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì¡°ì‘ =====
docker exec -it <container> bash    # ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆì— ëª…ë ¹ ì‹¤í–‰
docker logs <container>             # ë¡œê·¸ ì¶œë ¥
docker logs -f <container>          # ë¡œê·¸ ì‹¤ì‹œê°„ ì¶”ì  (follow)
docker logs --tail 100 <container>  # ë§ˆì§€ë§‰ 100ì¤„ë§Œ
docker top <container>              # ì»¨í…Œì´ë„ˆ ë‚´ í”„ë¡œì„¸ìŠ¤ ëª©ë¡
docker stats                        # ëª¨ë“  ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ (ì‹¤ì‹œê°„)
docker cp <container>:/path /local  # ì»¨í…Œì´ë„ˆ â†’ í˜¸ìŠ¤íŠ¸ íŒŒì¼ ë³µì‚¬
```

### 6.2 ì»¨í…Œì´ë„ˆ ë¼ì´í”„ì‚¬ì´í´ íë¦„

```
docker create          docker start         docker stop
   (Created) â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ (Running) â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ (Stopped)
                            â”‚                    â”‚
                            â”‚ docker pause       â”‚ docker start
                            â–¼                    â”‚
                         (Paused) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
                            â”‚ docker unpause
                            â–¼
                         (Running)
                            â”‚
                            â”‚ docker rm
                            â–¼
                        (Deleted)
```

### 6.3 í•µì‹¬ ì‹¤í–‰ ì˜µì…˜

```bash
# í¬íŠ¸ ë§¤í•‘: í˜¸ìŠ¤íŠ¸ 8080 â†’ ì»¨í…Œì´ë„ˆ 80
docker run -d -p 8080:80 nginx

# ì´ë¦„ ì§€ì •
docker run -d --name my-web nginx

# í™˜ê²½ë³€ìˆ˜ ì„¤ì •
docker run -d -e MYSQL_ROOT_PASSWORD=secret mysql:8

# ë¦¬ì†ŒìŠ¤ ì œí•œ (Week 2 Cgroupsì™€ ì§ê²°)
docker run -d --cpus="0.5" --memory="512m" nginx

# ìë™ ì¬ì‹œì‘ ì •ì±…
docker run -d --restart=unless-stopped nginx

# ì¡°í•© ì˜ˆì‹œ: ì´ë¦„ + í¬íŠ¸ + í™˜ê²½ë³€ìˆ˜ + ë¦¬ì†ŒìŠ¤ ì œí•œ
docker run -d \
  --name my-app \
  -p 3000:3000 \
  -e NODE_ENV=production \
  --cpus="1.0" \
  --memory="1g" \
  --restart=unless-stopped \
  my-app-image:v1.0
```

### 6.4 ì»¨í…Œì´ë„ˆ ì •ë³´ ì¡°íšŒ

```bash
# ì»¨í…Œì´ë„ˆ ìƒì„¸ ì •ë³´ (JSON)
docker inspect my-web

# íŠ¹ì • í•„ë“œë§Œ ì¶”ì¶œ (Go template)
docker inspect --format='{{.State.Status}}' my-web
# running

docker inspect --format='{{.NetworkSettings.IPAddress}}' my-web
# 172.17.0.2

# ë§ˆìš´íŠ¸ ì •ë³´
docker inspect --format='{{json .Mounts}}' my-web | python3 -m json.tool

# í™˜ê²½ë³€ìˆ˜ í™•ì¸
docker exec my-web env
```

<br>

## 7. docker run ë‚´ë¶€ ë™ì‘ ë¶„ì„

`docker run` í•œ ì¤„ì´ ì‹¤í–‰ë  ë•Œ ë‚´ë¶€ì—ì„œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.

```bash
docker run -d --name my-web -p 8080:80 nginx:latest
```

### 7.1 ì „ì²´ íë¦„

```
Docker Client
    â”‚
    â”‚ 1. REST API ìš”ì²­: POST /containers/create
    â–¼
Docker Daemon (dockerd)
    â”‚
    â”‚ 2. ì´ë¯¸ì§€ í™•ì¸ (ë¡œì»¬ì— ìˆëŠ”ì§€?)
    â”‚    â””â”€â”€ ì—†ìœ¼ë©´ Docker Hubì—ì„œ Pull
    â”‚
    â”‚ 3. ì»¨í…Œì´ë„ˆ ìƒì„± ìš”ì²­ â†’ containerdì— ì „ë‹¬
    â–¼
containerd
    â”‚
    â”‚ 4. ì´ë¯¸ì§€ ì–¸íŒ© (ë ˆì´ì–´ ì¤€ë¹„)
    â”‚
    â”‚ 5. OCI Runtime Spec (config.json) ìƒì„±
    â”‚    - Namespace ì„¤ì •
    â”‚    - Cgroups ì„¤ì •
    â”‚    - Mount ì„¤ì •
    â”‚
    â”‚ 6. runc ì‹¤í–‰ ìš”ì²­
    â–¼
runc
    â”‚
    â”‚ 7. Linux Namespace ìƒì„± (PID, NET, MNT, UTS, IPC)
    â”‚ 8. Cgroups ì„¤ì • (ë¦¬ì†ŒìŠ¤ ì œí•œ)
    â”‚ 9. Root Filesystem ë§ˆìš´íŠ¸ (OverlayFS)
    â”‚ 10. ë„¤íŠ¸ì›Œí¬ ì„¤ì • (veth pair, bridge)
    â”‚ 11. nginx í”„ë¡œì„¸ìŠ¤ ì‹œì‘ (PID 1)
    â–¼
Container Running!
```

### 7.2 ë‹¨ê³„ë³„ ìƒì„¸

**Step 1-2: ì´ë¯¸ì§€ í™•ì¸ & Pull**

```bash
# ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ê³¼ì • ì§ì ‘ ë³´ê¸°
docker pull nginx:latest
# latest: Pulling from library/nginx
# a1b2c3d4e5f6: Pull complete    â† Layer 1
# d7e8f9a0b1c2: Pull complete    â† Layer 2
# e3f4a5b6c7d8: Pull complete    â† Layer 3
# ...
# Digest: sha256:abcdef...
# Status: Downloaded newer image for nginx:latest
```

ê° ë ˆì´ì–´ëŠ” ë…ë¦½ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤. ì´ë¯¸ ë¡œì»¬ì— ì¡´ì¬í•˜ëŠ” ë ˆì´ì–´ëŠ” ì¬ë‹¤ìš´ë¡œë“œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**Step 3-6: ì»¨í…Œì´ë„ˆ ìƒì„±**

```bash
# ì»¨í…Œì´ë„ˆ ìƒì„± ì§í›„ (ì•„ì§ ë¯¸ì‹¤í–‰) ìƒíƒœ í™•ì¸
docker create --name test-create nginx
docker ps -a --filter name=test-create
# STATUS: Created
```

**Step 7-11: í”„ë¡œì„¸ìŠ¤ ì‹œì‘**

```bash
# ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name my-web -p 8080:80 nginx:latest

# ì‹¤í–‰ í™•ì¸
docker ps
# CONTAINER ID   IMAGE         STATUS         PORTS                  NAMES
# a1b2c3d4e5f6   nginx:latest  Up 5 seconds   0.0.0.0:8080->80/tcp   my-web

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í”„ë¡œì„¸ìŠ¤ í™•ì¸
docker top my-web
# PID    USER   COMMAND
# 1234   root   nginx: master process nginx -g daemon off;
# 5678   101    nginx: worker process

# í˜¸ìŠ¤íŠ¸ì—ì„œ ì»¨í…Œì´ë„ˆ í”„ë¡œì„¸ìŠ¤ í™•ì¸ (Linux)
ps aux | grep nginx
# í˜¸ìŠ¤íŠ¸ PIDë¡œ ë³´ì´ì§€ë§Œ, ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œëŠ” PID 1ë¡œ ë³´ì„
```

### 7.3 docker inspectë¡œ ë‚´ë¶€ êµ¬ì¡° í™•ì¸

```bash
docker inspect my-web | python3 -m json.tool

# ì£¼ìš” í™•ì¸ í•­ëª©:
# .State.Pid        â†’ í˜¸ìŠ¤íŠ¸ì—ì„œì˜ PID
# .State.Status     â†’ running/exited/paused
# .NetworkSettings  â†’ IP ì£¼ì†Œ, í¬íŠ¸ ë§¤í•‘
# .HostConfig       â†’ ë¦¬ì†ŒìŠ¤ ì œí•œ, ì¬ì‹œì‘ ì •ì±…
# .GraphDriver      â†’ ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„ (overlay2)
# .Config.Env       â†’ í™˜ê²½ë³€ìˆ˜
# .Config.Cmd       â†’ ì‹¤í–‰ ëª…ë ¹ì–´
```

<br>

## 8. ì´ë¯¸ì§€ ì´ì‹ì„±: docker save/load

Dockerì˜ ê°€ì¥ ê°•ë ¥í•œ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” **ì´ë¯¸ì§€ì˜ ì™„ë²½í•œ ì´ì‹ì„±**ì…ë‹ˆë‹¤.

### 8.1 ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

ë„¤íŠ¸ì›Œí¬ê°€ ì—†ëŠ” í™˜ê²½ì´ë‚˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ ìƒí™©ì—ì„œ ì´ë¯¸ì§€ë¥¼ íŒŒì¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
ê°œë°œ ì„œë²„ (ì¸í„°ë„· O)          ìš´ì˜ ì„œë²„ (ì¸í„°ë„· X)
     â”‚                              â”‚
     â”‚  Docker Hubì—ì„œ              â”‚  Docker Hub ì ‘ê·¼ ë¶ˆê°€
     â”‚  ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥         â”‚
     â”‚                              â”‚
     â””â”€â”€â”€â–¶  docker save  â”€â”€â”€â”€â”€â–¶  docker load  â”€â”€â”€â–¶
              (tar íŒŒì¼ë¡œ ì €ì¥)    (tar íŒŒì¼ì—ì„œ ë¡œë“œ)
```

### 8.2 ì‹¤ìŠµ

```bash
# === ê°œë°œ ì„œë²„ì—ì„œ ===

# ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
docker pull nginx:1.25

# tar íŒŒì¼ë¡œ ì €ì¥
docker save nginx:1.25 -o nginx-1.25.tar
ls -lh nginx-1.25.tar
# -rw-r--r-- 1 user user 140M ...

# gzip ì••ì¶•ìœ¼ë¡œ ìš©ëŸ‰ ì ˆê°
docker save nginx:1.25 | gzip > nginx-1.25.tar.gz
ls -lh nginx-1.25.tar.gz
# -rw-r--r-- 1 user user 52M ...  (63% ê°ì†Œ)

# ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì €ì¥
docker save nginx:1.25 postgres:15 redis:7 -o stack.tar

# íŒŒì¼ ì „ì†¡ (SCP, USB, ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ë“±)
scp nginx-1.25.tar.gz production-server:/tmp/
```

```bash
# === ìš´ì˜ ì„œë²„ì—ì„œ ===

# tarì—ì„œ ì´ë¯¸ì§€ ë¡œë“œ
docker load -i /tmp/nginx-1.25.tar
# Loaded image: nginx:1.25

# gzip ì••ì¶• í•´ì œí•˜ë©° ë¡œë“œ
gunzip -c /tmp/nginx-1.25.tar.gz | docker load
# Loaded image: nginx:1.25

# í™•ì¸ ë° ì‹¤í–‰
docker images
docker run -d -p 80:80 nginx:1.25
```

### 8.3 docker save vs docker export

| &nbsp;ëª…ë ¹ì–´&nbsp; | &nbsp;ëŒ€ìƒ&nbsp; | &nbsp;í¬í•¨ ë‚´ìš©&nbsp; | &nbsp;ìš©ë„&nbsp; |
|---|---|---|---|
| docker save | ì´ë¯¸ì§€ | ëª¨ë“  ë ˆì´ì–´ + ë©”íƒ€ë°ì´í„° + íƒœê·¸ | ì´ë¯¸ì§€ ì „ì²´ ë°±ì—…/ì „ë‹¬ |
| docker export | ì»¨í…Œì´ë„ˆ | í˜„ì¬ íŒŒì¼ì‹œìŠ¤í…œ ìŠ¤ëƒ…ìƒ· (1ê°œ ë ˆì´ì–´) | ì»¨í…Œì´ë„ˆ ìƒíƒœ ì¶”ì¶œ |

```bash
# docker export ì˜ˆì‹œ (ì»¨í…Œì´ë„ˆ íŒŒì¼ì‹œìŠ¤í…œì„ tarë¡œ ì¶”ì¶œ)
docker export my-web -o my-web-fs.tar

# íŒŒì¼ì‹œìŠ¤í…œ ë‚´ìš© í™•ì¸
tar -tf my-web-fs.tar | head -20
```

<br>

## 9. ì‹¤ì „ ì¢…í•© ì‹¤ìŠµ

### ì‹¤ìŠµ 1: ì›¹ ì„œë²„ ì»¨í…Œì´ë„ˆ ìš´ì˜

```bash
# 1. Nginx ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name web-server -p 8080:80 nginx:latest

# 2. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì† í™•ì¸
curl http://localhost:8080

# 3. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì§„ì…
docker exec -it web-server bash
cat /etc/nginx/nginx.conf
exit

# 4. ë¡œê·¸ í™•ì¸
docker logs web-server
docker logs -f web-server   # ì‹¤ì‹œê°„ ì¶”ì 

# 5. ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§
docker stats web-server

# 6. ì»¨í…Œì´ë„ˆ ì¤‘ì§€ â†’ ì¬ì‹œì‘ â†’ ì‚­ì œ
docker stop web-server
docker start web-server
docker rm -f web-server
```

---

### ì‹¤ìŠµ 2: ì»¨í…Œì´ë„ˆ ë¼ì´í”„ì‚¬ì´í´ ì „ì²´ ìˆœí™˜

```bash
# 1. create â†’ start â†’ stop â†’ rm ì „ì²´ ìˆœí™˜
docker create --name lifecycle-test nginx
docker ps -a | grep lifecycle-test   # STATUS: Created

docker start lifecycle-test
docker ps | grep lifecycle-test      # STATUS: Up X seconds

docker pause lifecycle-test
docker ps | grep lifecycle-test      # STATUS: Up X seconds (Paused)

docker unpause lifecycle-test
docker ps | grep lifecycle-test      # STATUS: Up X seconds

docker stop lifecycle-test
docker ps -a | grep lifecycle-test   # STATUS: Exited (0)

docker rm lifecycle-test
docker ps -a | grep lifecycle-test   # (ì—†ìŒ)
```

---

### ì‹¤ìŠµ 3: docker inspect ì‹¬ì¸µ ë¶„ì„

```bash
# 1. ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d --name inspect-test -p 9090:80 --cpus="0.5" --memory="256m" nginx

# 2. PID í™•ì¸ (Linux)
docker inspect --format='{{.State.Pid}}' inspect-test

# 3. ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸
docker inspect --format='{{.NetworkSettings.IPAddress}}' inspect-test

# 4. í¬íŠ¸ ë§¤í•‘ í™•ì¸
docker inspect --format='{{json .NetworkSettings.Ports}}' inspect-test | python3 -m json.tool

# 5. ë¦¬ì†ŒìŠ¤ ì œí•œ í™•ì¸
docker inspect --format='{{.HostConfig.NanoCpus}}' inspect-test
# 500000000 (0.5 CPU = 500,000,000 NanoCPUs)

docker inspect --format='{{.HostConfig.Memory}}' inspect-test
# 268435456 (256MB = 256 Ã— 1024 Ã— 1024)

# 6. ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„ í™•ì¸
docker inspect --format='{{.GraphDriver.Name}}' inspect-test
# overlay2

# 7. ì •ë¦¬
docker rm -f inspect-test
```

---

### ì‹¤ìŠµ 4: docker save/load ì´ë¯¸ì§€ ì „ë‹¬

```bash
# 1. ì´ë¯¸ì§€ ì €ì¥
docker pull alpine:3.19
docker save alpine:3.19 | gzip > alpine-3.19.tar.gz
ls -lh alpine-3.19.tar.gz

# 2. ë¡œì»¬ ì´ë¯¸ì§€ ì‚­ì œ
docker rmi alpine:3.19
docker images | grep alpine   # (ì—†ìŒ)

# 3. tarì—ì„œ ë³µì›
gunzip -c alpine-3.19.tar.gz | docker load
docker images | grep alpine   # alpine:3.19 ë³µì› í™•ì¸

# 4. ì‹¤í–‰ í™•ì¸
docker run --rm alpine:3.19 echo "Image restored successfully!"
```

<br>

## í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Bare Metal / VM / Containerì˜ ì°¨ì´ë¥¼ ë™ë£Œì—ê²Œ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] Dockerê°€ í•´ê²°í•˜ëŠ” 3ê°€ì§€ í•µì‹¬ ë¬¸ì œë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] Docker ì•„í‚¤í…ì²˜ (Client â†’ Daemon â†’ containerd â†’ runc)ë¥¼ ë„ì‹í™”í•  ìˆ˜ ìˆë‹¤
- [ ] docker run / ps / stop / rm / logs / exec ëª…ë ¹ì–´ë¥¼ ììœ ë¡­ê²Œ ì‚¬ìš©í•œë‹¤
- [ ] í¬íŠ¸ ë§¤í•‘(-p), í™˜ê²½ë³€ìˆ˜(-e), ë°±ê·¸ë¼ìš´ë“œ(-d) ì˜µì…˜ì„ ì´í•´í•˜ê³  ì¡°í•©í•œë‹¤
- [ ] docker inspectë¡œ ì»¨í…Œì´ë„ˆì˜ PID, IP, ë¦¬ì†ŒìŠ¤ ì œí•œì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤
- [ ] ì´ë¯¸ì§€ì™€ ì»¨í…Œì´ë„ˆì˜ ê´€ê³„ (í‹€ vs ë¶•ì–´ë¹µ)ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] docker save/loadë¡œ ì˜¤í”„ë¼ì¸ í™˜ê²½ì— ì´ë¯¸ì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤
- [ ] docker run ì‹¤í–‰ ì‹œ ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” ë‹¨ê³„ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤

<br>

## ë‹¤ìŒ ì£¼ ì˜ˆê³ 

[Week 2]({% post_url k8s/2025-01-03-k8s-week02-linux-container-isolation %})ì—ì„œëŠ” Docker ì»¨í…Œì´ë„ˆê°€ ì‹¤ì œë¡œ ì–´ë–»ê²Œ í”„ë¡œì„¸ìŠ¤ë¥¼ ê²©ë¦¬í•˜ëŠ”ì§€ **Linux ì»¤ë„ ë ˆë²¨**ì—ì„œ ì‹¬ì¸µ ë¶„ì„í•©ë‹ˆë‹¤. Namespace, Cgroups, OverlayFSë¥¼ ì§ì ‘ ë‹¤ë¤„ë³´ê³ , containerdì™€ runcë¥¼ ì²´í—˜í•©ë‹ˆë‹¤.

<br>

## ì°¸ê³  ìë£Œ

- [Docker ê³µì‹ ë¬¸ì„œ - Get Started](https://docs.docker.com/get-started/)
- [Docker ê³µì‹ ë¬¸ì„œ - Docker Architecture](https://docs.docker.com/get-started/overview/#docker-architecture)
- [Docker ê³µì‹ ë¬¸ì„œ - CLI Reference](https://docs.docker.com/reference/cli/docker/)
- [Docker ê³µì‹ ì„¤ì¹˜ ê°€ì´ë“œ (Ubuntu)](https://docs.docker.com/engine/install/ubuntu/)
- [roadmap.sh/docker](https://roadmap.sh/docker) - Docker í•™ìŠµ ë¡œë“œë§µ
